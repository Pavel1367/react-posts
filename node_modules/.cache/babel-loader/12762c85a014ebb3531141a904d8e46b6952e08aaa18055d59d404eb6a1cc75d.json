{"ast":null,"code":"import _toConsumableArray from\"C:/Users/888/Desktop/ulbireact/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/888/Desktop/ulbireact/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/888/Desktop/ulbireact/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/888/Desktop/ulbireact/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useMemo,useEffect}from\"react\";import PostForm from\"../components/PostForm\";import PostList from\"../components/PostList\";import\"../styles/App.css\";import PostFilter from\"../components/PostFilter\";import Modal from\"../components/UI/modal/Modal\";import Button from\"../components/UI/button/Button\";import{usePosts}from\"../hooks/usePosts\";import{getPageCount,getPagesArray}from\"../components/utils/pages\";import PostService from\"../API/PostService\";import Loader from\"../components/UI/loader/Loader\";import{useFetching}from\"../hooks/useFetching\";import Pagination from\"../components/UI/pagination/Pagination\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Posts(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState({sort:\"\",query:\"\"}),_useState4=_slicedToArray(_useState3,2),filter=_useState4[0],setFilter=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modal=_useState6[0],setModal=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),totalPages=_useState8[0],setTotalPages=_useState8[1];var _useState9=useState(10),_useState10=_slicedToArray(_useState9,2),limit=_useState10[0],setLimit=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),page=_useState12[0],setPage=_useState12[1];var sortedAndSearchedPosts=usePosts(posts,filter.sort,filter.query);var _useFetching=useFetching(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,totalCount;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return PostService.getAll(limit,page);case 2:response=_context.sent;setPosts(response.data);totalCount=response.headers[\"x-total-count\"];setTotalPages(getPageCount(totalCount,limit));case 6:case\"end\":return _context.stop();}}},_callee);}))),_useFetching2=_slicedToArray(_useFetching,3),fetchPosts=_useFetching2[0],arePostsLoading=_useFetching2[1],postError=_useFetching2[2];useEffect(function(){fetchPosts();},[page]);var createPost=function createPost(newPost){setPosts([].concat(_toConsumableArray(posts),[newPost]));setModal(false);};var removePost=function removePost(post){setPosts(posts.filter(function(p){return p.id!==post.id;}));};var changePage=function changePage(page){setPage(page);};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setModal(true);},children:\"Create post\"}),/*#__PURE__*/_jsx(Modal,{visible:modal,setVisible:setModal,children:/*#__PURE__*/_jsx(PostForm,{create:createPost})}),/*#__PURE__*/_jsx(\"hr\",{style:{margin:\"10px 0\"}}),/*#__PURE__*/_jsx(PostFilter,{filter:filter,setFilter:setFilter}),arePostsLoading?/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"center\",marginTop:\"30vh\"},children:/*#__PURE__*/_jsx(Loader,{})}):/*#__PURE__*/_jsx(PostList,{remove:removePost,posts:sortedAndSearchedPosts,title:\"List\"}),/*#__PURE__*/_jsx(Pagination,{page:page,changePage:changePage,totalPages:totalPages})]});}export default Posts;","map":{"version":3,"names":["React","useState","useMemo","useEffect","PostForm","PostList","PostFilter","Modal","Button","usePosts","getPageCount","getPagesArray","PostService","Loader","useFetching","Pagination","Posts","posts","setPosts","sort","query","filter","setFilter","modal","setModal","totalPages","setTotalPages","limit","setLimit","page","setPage","sortedAndSearchedPosts","getAll","response","data","totalCount","headers","fetchPosts","arePostsLoading","postError","createPost","newPost","removePost","post","p","id","changePage","margin","display","justifyContent","marginTop"],"sources":["C:/Users/888/Desktop/ulbireact/src/pages/Posts.jsx"],"sourcesContent":["import React, { useState, useMemo, useEffect } from \"react\";\r\nimport PostForm from \"../components/PostForm\";\r\nimport PostList from \"../components/PostList\";\r\nimport \"../styles/App.css\";\r\nimport PostFilter from \"../components/PostFilter\";\r\nimport Modal from \"../components/UI/modal/Modal\";\r\nimport Button from \"../components/UI/button/Button\";\r\nimport { usePosts } from \"../hooks/usePosts\";\r\nimport { getPageCount, getPagesArray } from \"../components/utils/pages\";\r\nimport PostService from \"../API/PostService\";\r\nimport Loader from \"../components/UI/loader/Loader\";\r\nimport { useFetching } from \"../hooks/useFetching\";\r\nimport Pagination from \"../components/UI/pagination/Pagination\";\r\nfunction Posts() {\r\n  const [posts, setPosts] = useState([]);\r\n  const [filter, setFilter] = useState({ sort: \"\", query: \"\" });\r\n  const [modal, setModal] = useState(false);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n  const [limit, setLimit] = useState(10);\r\n  const [page, setPage] = useState(1);\r\n  const sortedAndSearchedPosts = usePosts(posts, filter.sort, filter.query);\r\n\r\n  const [fetchPosts, arePostsLoading, postError] = useFetching(async () => {\r\n    const response = await PostService.getAll(limit, page);\r\n    setPosts(response.data);\r\n    const totalCount = response.headers[\"x-total-count\"];\r\n    setTotalPages(getPageCount(totalCount, limit));\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetchPosts();\r\n  }, [page]);\r\n\r\n  const createPost = (newPost) => {\r\n    setPosts([...posts, newPost]);\r\n    setModal(false);\r\n  };\r\n\r\n  const removePost = (post) => {\r\n    setPosts(posts.filter((p) => p.id !== post.id));\r\n  };\r\n\r\n  const changePage = (page) => {\r\n    setPage(page);\r\n  };\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Button onClick={() => setModal(true)}>Create post</Button>\r\n      <Modal visible={modal} setVisible={setModal}>\r\n        <PostForm create={createPost} />\r\n      </Modal>\r\n\r\n      <hr style={{ margin: \"10px 0\" }} />\r\n      <PostFilter filter={filter} setFilter={setFilter} />\r\n\r\n      {arePostsLoading ? (\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            marginTop: \"30vh\",\r\n          }}\r\n        >\r\n          <Loader />\r\n        </div>\r\n      ) : (\r\n        <PostList\r\n          remove={removePost}\r\n          posts={sortedAndSearchedPosts}\r\n          title=\"List\"\r\n        />\r\n      )}\r\n      <Pagination page={page} changePage={changePage} totalPages={totalPages} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Posts;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}